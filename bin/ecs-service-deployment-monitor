#!/usr/bin/env node

var AWS = require('aws-sdk');
AWS.config.update({region:'us-east-1'});

var ecsServiceDeploymentMonitor = require('../');

var argv = require('yargs')
  .demand([ 'cluster', 'service', 'task-definition' ])
  .argv;

var options = {
  clusterArn: argv.cluster,
  serviceName: argv.service,
  taskDefinitionArn: argv.taskDefinition
};

// var stream = ecsServiceDeploymentMonitor(options);
//
// stream.on('error', (err) => {
//   throw err;
// });
//
// stream.on('data', (data) => {
//   console.log(data);
// });

var Service = require('../lib/service');

service = new Service(options);

service.on('error', (err) => {
  throw err;
});

service.on('event', (event) => {
  console.log(event.raw.message);
});
